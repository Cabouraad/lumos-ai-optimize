project_id = "cgocsffxqyhojtyzniyz"

# TODO: Security audit completed - All verify_jwt=false functions have proper internal auth:
# - daily-batch-trigger: Validates cron secret against database
# - daily-scheduler-deprecated: Legacy function (consider removal)  
# - batch-reconciler: Validates cron secret + supports manual calls
# - robust-batch-processor: Requires Bearer token OR valid cron secret
# - stripe-webhook: Uses Stripe signature validation (industry standard)
# - weekly-report: Validates CRON_SECRET for scheduled runs OR valid JWT for user requests

[functions.daily-batch-trigger]
verify_jwt = false
import_map = ""

[functions.admin-batch-trigger]
verify_jwt = true

[functions.daily-scheduler-deprecated]
verify_jwt = false

[functions.batch-reconciler]
verify_jwt = false

[functions.enhanced-prompt-suggestions]
verify_jwt = true

[functions.analyze-ai-response]
verify_jwt = true

[functions.brand-enrich]
verify_jwt = true

[functions.sync-cron-secret]
verify_jwt = true

[functions.sync-competitor-detection]
verify_jwt = true

[functions.fix-prompt-classification]
verify_jwt = true

[functions.robust-batch-processor]
verify_jwt = false

[functions.check-subscription]
verify_jwt = true

[functions.create-checkout]
verify_jwt = true

[functions.customer-portal]
verify_jwt = true

[functions.weekly-suggestions]
verify_jwt = true

[functions.verify-domain]
verify_jwt = true

[functions.run-prompt-now]
verify_jwt = true

[functions.suggest-prompts-now]
verify_jwt = true

[functions.onboarding]
verify_jwt = true

[functions.auto-fill-business-context]
verify_jwt = true

[functions.advanced-recommendations]
verify_jwt = true

[functions.test-prompt-response]
verify_jwt = true

[functions.delete-account]
verify_jwt = true

[functions.llms-generate]
verify_jwt = true

[functions.create-trial-checkout]
verify_jwt = true

[functions.activate-trial]
verify_jwt = true

[functions.test-single-provider]
verify_jwt = true

[functions.convert-competitor-to-brand]
verify_jwt = true

[functions.grant-starter-bypass]
verify_jwt = true

[functions.remove-test-access]
verify_jwt = true

[functions.remove-bypass]
verify_jwt = true

[functions.stripe-webhook]
verify_jwt = false

[functions.generate-weekly-report]
verify_jwt = true

[functions.weekly-report-scheduler]
verify_jwt = false

[functions.weekly-report]
verify_jwt = false

[functions.reports-sign]
verify_jwt = true

[functions.check-subscription-scheduled]
verify_jwt = false

[functions.diag]
verify_jwt = false

# Scheduled runs every Monday 08:00 UTC (end of previous week); adjust if you prefer Sunday.
[functions.schedules]
weekly_report_mon = { schedule = "0 8 * * MON", endpoint = "/weekly-report", method = "POST", headers = { authorization = "Bearer ${CRON_SECRET}" } }
daily_subscription_check = { schedule = "0 2 * * *", endpoint = "/check-subscription-scheduled", method = "POST", headers = { "x-cron-secret" = "${CRON_SECRET}" } }